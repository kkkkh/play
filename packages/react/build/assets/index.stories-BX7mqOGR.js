const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./FormButtons-C3wFl97h.js","./index-DBeYIoHf.js","./index-Bsr3yfDJ.css"])))=>i.map(i=>d[i]);
import{r as a,j as e,a as h,R as p,_ as x}from"./index-DBeYIoHf.js";function j(){const[t,n]=a.useState(),s=async r=>{const i=r.get("name");await new Promise(o=>setTimeout(o,1e3)),n(i)};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"FormAction"}),e.jsxs("form",{action:s,children:[e.jsx("input",{type:"text",name:"name",placeholder:"联系人名称"}),e.jsx("button",{type:"submit",children:"提交"}),t&&e.jsxs("p",{children:["您提交的联系人名称是：",t]})]})]})}function f(){const{pending:t}=h.useFormStatus();return e.jsx("button",{type:"submit",disabled:t,children:t?"提交中...":"提交"})}function g(){const[t,n]=a.useState(),s=async r=>{const i=r.get("name");await new Promise(o=>setTimeout(o,1e3)),n(i)};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"useFormStatus"}),e.jsxs("form",{action:s,children:[e.jsx("input",{type:"text",name:"name",placeholder:"联系人名称"}),e.jsx(f,{}),t&&e.jsxs("p",{children:["您提交的联系人名称是：",t]})]})]})}function y(t){return e.jsx("button",{type:"submit",disabled:t.pending,children:t.pending?"提交中...":"提交"})}function A(){const[t,n,s]=a.useActionState(async(r,i)=>{const o=i.get("name");return await new Promise(c=>setTimeout(c,1e3)),{...r,success:!0,name:o+"+1"}},{});return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"useActionState"}),e.jsxs("form",{action:n,children:[e.jsx("input",{type:"text",name:"name",placeholder:"联系人名称"}),e.jsx(y,{pending:s}),s&&e.jsx("p",{children:"提交中..."}),t.success&&e.jsxs("p",{children:["您提交的联系人名称是：",t.name]})]})]})}function v(t){return e.jsx("button",{type:"submit",disabled:t.pending,children:t.pending?"提交中...":"提交"})}function b(){const[t,n,s]=a.useActionState(async(o,c)=>{const u=c.get("name");return i(u),await new Promise(d=>setTimeout(d,1e3)),{...o,success:!0,name:u+"+2"}},{}),[r,i]=a.useOptimistic(t,(o,c)=>({...o,name:c}));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"useOptimistic"}),e.jsxs("form",{action:n,children:[e.jsx("input",{type:"text",name:"name",placeholder:"联系人名称"}),e.jsx(v,{pending:s}),e.jsxs("p",{children:["您提交的联系人名称是：",r.name,s?e.jsx("span",{children:"(提交中...)"}):t.success&&e.jsx("span",{children:"(提交成功!)"})]})]})]})}function D(){return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(j,{}),e.jsx(g,{}),e.jsx(A,{}),e.jsx(b,{})]})})}const w=p.lazy(()=>x(()=>import("./FormButtons-C3wFl97h.js"),__vite__mapDeps([0,1,2]),import.meta.url));function E(){const[t,n,s]=a.useActionState(async(r,i)=>{const o=i.get("name");return await new Promise(c=>setTimeout(c,2e3)),{...r,success:!0,name:o+"+1"}},{});return e.jsxs("form",{action:n,children:[e.jsx("input",{type:"text",name:"name",placeholder:"联系人名称"}),e.jsx(a.Suspense,{fallback:e.jsx("span",{children:"加载中..."}),children:e.jsx(w,{})}),s&&e.jsx("p",{children:"提交中..."}),t.success&&e.jsxs("p",{children:["您提交的联系人名称是：",t.name]})]})}const S=a.createContext(null),l={didCatch:!1,error:null};class C extends a.Component{constructor(n){super(n),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=l}static getDerivedStateFromError(n){return{didCatch:!0,error:n}}resetErrorBoundary(){const{error:n}=this.state;if(n!==null){for(var s,r,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];(s=(r=this.props).onReset)===null||s===void 0||s.call(r,{args:o,reason:"imperative-api"}),this.setState(l)}}componentDidCatch(n,s){var r,i;(r=(i=this.props).onError)===null||r===void 0||r.call(i,n,s)}componentDidUpdate(n,s){const{didCatch:r}=this.state,{resetKeys:i}=this.props;if(r&&s.error!==null&&F(n.resetKeys,i)){var o,c;(o=(c=this.props).onReset)===null||o===void 0||o.call(c,{next:i,prev:n.resetKeys,reason:"keys"}),this.setState(l)}}render(){const{children:n,fallbackRender:s,FallbackComponent:r,fallback:i}=this.props,{didCatch:o,error:c}=this.state;let u=n;if(o){const d={error:c,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")u=s(d);else if(r)u=a.createElement(r,d);else if(i!==void 0)u=i;else throw c}return a.createElement(S.Provider,{value:{didCatch:o,error:c,resetErrorBoundary:this.resetErrorBoundary}},u)}}function F(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==n.length||t.some((s,r)=>!Object.is(s,n[r]))}function B({contactsPromise:t}){const n=a.use(t);return e.jsx("ul",{children:n.map(s=>e.jsx("li",{children:s.name},s.id))})}function P(){const[t]=a.useState(()=>new Promise(n=>{setTimeout(()=>{n([{id:1,name:"张三"},{id:2,name:"李四"},{id:3,name:"王五"}])},2e3)}));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"react19 use promise"}),e.jsx(C,{fallback:e.jsx("div",{children:"加载失败"}),children:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"读取中1..."}),children:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"读取中2..."}),children:e.jsx(B,{contactsPromise:t})})})})]})}const m=a.createContext("");function T(){return e.jsx(m,{value:"1",children:e.jsx(N,{})})}function N(){const[t,n]=a.useState("BOSS"),s=t==="BOSS"?"true":a.use(m);return e.jsxs("div",{children:[e.jsx("h2",{children:"react19 use context"}),e.jsxs("p",{children:["isAdmin: ",s]}),e.jsx("button",{onClick:()=>{n("employee")},children:"设置"})]})}function O(){return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(E,{}),e.jsx(P,{}),e.jsx(T,{})]})})}function R({title:t,onChange:n,onKeyDown:s,ref:r}){return e.jsx("input",{type:"text",value:t,ref:r,onChange:n,onKeyDown:s})}function K(){const t=a.useRef(null);a.useEffect(()=>{setTimeout(()=>t.current.focus(),100)},[]),console.log(_.partition([1,2,3,4],r=>r%2));function n(){console.log("change")}function s(){console.log("keydown")}return e.jsxs("div",{children:[e.jsx("h2",{children:"react19 ref"}),e.jsx(R,{ref:t,onChange:n,onKeyDown:s})]})}const $={title:"React / React19"};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{D as Action,K as Ref19,O as Use,$ as default};
